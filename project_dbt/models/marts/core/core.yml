
version: 2

models:
  - name: dim_date
    description: '{{ doc("dim_date") }}'
    columns:
      - name: date
        description: Calendar date
        tests:
          - unique
          - not_null

      - name: day
        description: Day number

      - name: month
        description: Month number

      - name: month_name
        description: Month name

      - name: calendar_quarter
        description: "Based on 1: Jan-Mar, 2: Apr-Jun, 3: Jul-Sep, 4: Oct-Dec"

      - name: calendar_quarter_name
        description: 	Calendar quarter name

      - name: calendar_year
        description: Full four digit year

      - name: month_sort_order
        description: Looks at school year as July - June


  - name: dim_demographic
    description: '{{ doc("dim_demographic") }}'
    columns:
      - name: demographic_key
        description: Concatenation of parent key and descrptor code value
        tests:
          - unique
          - not_null

      - name: demographic_parent_key
        description: Descriptor parent key. For example, 'RaceDescriptors' will show 'Race' here

      - name: demographic_label
        description: Short description of the descriptor


  - name: dim_grading_period
    description: ""
    columns:
      - name: grading_period_key
        description: "Concatenation of grading period descriptor code value, school id, and grading period begin date."
        tests:
          - unique
          - not_null
      - name: school_key
        description: "School ID."
        tests:
          - relationships:
              to: ref('dim_school')
              field: school_key
      - name: grading_period_description
        description: "Grading period descriptor code value."
      - name: period_sequence
        description: "The sequential order of this period relative to other periods."
      - name: grading_period_begin_date_key
        description: "Month, day, and year of the first day of the grading period."
      - name: grading_period_end_date_key
        description: "Month, day, and year of the last day of the grading period."
      - name: number_of_days
        description: "Total days available for educational instruction during the grading period."


  - name: dim_local_education_agency
    description: ""
    columns:
      - name: local_education_agency_key
        description: "The identifier assigned to a local education agency."
        tests:
          - unique
          - not_null
      - name: local_education_agency_name
        description: "The name assigned to a local education agency."


  - name: dim_school
    description: ""
    columns:
      - name: school_key
        description: "The identifier assigned to a school."
        tests:
          - unique
          - not_null
      - name: school_name
        description: "The name assigned to a school."
      - name: school_type
        description: "The type of education institution as classified by its primary focus."
      - name: local_education_agency_key
        description: "The identifier assigned to a local education agency."
      - name: local_education_agency_name
        description: "The name assigned to a local education agency."


  - name: dim_student
    description: >
      Ed-Fi's Analytics Middle Tier provides two student dims related to the student's LEA association and the student's
      school association. This dim combines those two dims to provide one student dim that can be used downstream.
      If a student has multiple school enrollments, only their most recent will show in this dim.


  - name: dim_student_local_education_agency
    description: "Contains attributes of a student including name and demographic information as defined in relationship to the local education agency. If a student has multiple school year records for a LEA, only the latest is shown."
    columns:
      - name: student_local_education_agency_key
        description: "Primary key"
        tests:
          - unique
          - not_null
      - name: student_key
        description: "A unique alphanumeric code assigned to a student."
        tests:
          - not_null
      - name: local_education_agency_key
        description: "The identifier assigned to a local education agency."
        tests:
          - not_null
      - name: student_first_name
        description: "A name given to an individual at birth, baptism, or during another naming ceremony, or through legal change."
        tests:
          - not_null
      - name: student_middle_name
        description: "A secondary name given to an individual at birth, baptism, or during another naming ceremony."
      - name: student_last_surname
        description: "The name borne in common by members of a family."
        tests:
          - not_null
      - name: limited_english_proficiency
        description: "An indication that the student has been identified as limited English proficient by the Language Proficiency Assessment Committee (LPAC), or English proficient."
      - name: is_hispanic
        description: "An indication that the individual traces his or her origin or descent to Mexico, Puerto Rico, Cuba, Central, and South America, and other Spanish cultures, regardless of race, as last reported to the education organization."
        tests:
          - not_null
          - accepted_values:
              values: ['true', 'false']
              quote: false
      - name: sex
        description: "The student's gender as last reported to the education organization."
      - name: internet_access_in_residence
        description: "The primary type of internet service used in the student's primary place of residence."


  - name: student_local_education_agency_demographics_bridge
    description: "This view provides student demographic information by linking the dim_student_local_education_agency to the dim_demographic."
    columns:
      - name: student_school_demographic_bridge_key
        description: "Concatenation of the demographic_key found in the dim_demographic with the student_local_education_agency_key found in the dim_student_local_education_agency."
        tests:
          - unique
          - not_null
      - name: student_local_education_agency_key
        description: "Concatenation of the student unique id and the LEA id."
      - name: demographic_key
        description: "Concatenation of parent key and label columns to allow for easier joins."

  - name: dim_student_program
    description: ""

  - name: dim_student_school
    description: Contains attributes of a student including name, enrollment, and demographic information as defined in relationship to a school at which the student is currently enrolled.
    columns:
      - name: "(student_school_key || '-' || enrollment_date_key)"
        tests:
          - unique
          - not_null
      - name: student_school_key
        description: Primary key
        tests:
          - not_null
      - name: student_key
        description: A unique alphanumeric code assigned to a student.
        tests:
          - not_null
      - name: school_year
        description: School year
        tests:
          - not_null
      - name: school_key
        description: The identifier assigned to a school.
      - name: student_first_name
        description: A name given to an individual at birth, baptism, or during another naming ceremony, or through legal change.
        tests:
          - not_null
      - name: student_middle_name
        description: A secondary name given to an individual at birth, baptism, or during another naming ceremony.
      - name: student_last_surname
        description: The name borne in common by members of a family.
        tests:
          - not_null
      - name: enrollment_date_key
        description: The month, day, and year on which an individual enters and begins to receive instructional services in a school.
        tests:
          - not_null
      - name: exit_date_key
        description: "The recorded exit or withdraw date for the student."
      - name: grade_level
        description: The grade level or primary instructional level at which a student enters and receives services in a school or an educational institution during a given academic session.
        tests:
          - not_null
      - name: limited_english_proficiency
        description: An indication that the student has been identified as limited English proficient by the Language Proficiency Assessment Committee (LPAC), or English proficient.
      - name: is_hispanic
        description: An indication that the individual traces his or her origin or descent to Mexico, Puerto Rico, Cuba, Central, and South America, and other Spanish cultures, regardless of race, as last reported to the education organization. The term, "Spanish origin," can be used in addition to "Hispanic or Latino."
        tests:
          - not_null
          - accepted_values:
              values: ['true', 'false']
              quote: false
      - name: sex
        description: The student's gender as last reported to the education organization.
      - name: birth_date
        description: The month, day, and year on which an individual was born.
      - name: internet_access_in_residence
        description: An indication of whether the student is able to access the internet in their primary place of residence.
